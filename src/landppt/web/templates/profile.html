{% extends "base.html" %}

{% block title %}ç”¨æˆ·èµ„æ–™ - LandPPT{% endblock %}

{% block content %}
<div style="text-align: center; margin-bottom: 40px;">
    <h2 style="color: #2c3e50; margin-bottom: 20px;">ğŸ‘¤ ç”¨æˆ·èµ„æ–™</h2>
    <p style="font-size: 1.1em; color: #7f8c8d;">
        ç®¡ç†æ‚¨çš„è´¦æˆ·ä¿¡æ¯å’Œå®‰å…¨è®¾ç½®
    </p>
</div>

{% if error %}
<div class="alert alert-error">
    {{ error }}
</div>
{% endif %}

{% if success %}
<div class="alert alert-success">
    {{ success }}
</div>
{% endif %}

<div class="grid">
    <div class="card">
        <h3 style="color: #3498db; margin-bottom: 20px;">ğŸ“‹ åŸºæœ¬ä¿¡æ¯</h3>
        
        <div style="background: #f8f9fa; padding: 20px; border-radius: 8px;">
            <div style="margin-bottom: 15px;">
                <strong>ç”¨æˆ·å:</strong> 
                <span style="color: #2c3e50;">{{ user.username }}</span>
            </div>
            
            {% if user.email %}
            <div style="margin-bottom: 15px;">
                <strong>é‚®ç®±:</strong> 
                <span style="color: #2c3e50;">{{ user.email }}</span>
            </div>
            {% endif %}
            
            <div style="margin-bottom: 15px;">
                <strong>è´¦æˆ·çŠ¶æ€:</strong> 
                {% if user.is_active %}
                    <span style="color: #27ae60;">âœ… æ´»è·ƒ</span>
                {% else %}
                    <span style="color: #e74c3c;">âŒ å·²ç¦ç”¨</span>
                {% endif %}
            </div>
            
            <div style="margin-bottom: 15px;">
                <strong>æƒé™çº§åˆ«:</strong> 
                {% if user.is_admin %}
                    <span style="background: #e74c3c; color: white; padding: 4px 12px; border-radius: 20px; font-size: 0.8em;">
                        ğŸ‘‘ ç®¡ç†å‘˜
                    </span>
                {% else %}
                    <span style="background: #3498db; color: white; padding: 4px 12px; border-radius: 20px; font-size: 0.8em;">
                        ğŸ‘¤ æ™®é€šç”¨æˆ·
                    </span>
                {% endif %}
            </div>
            
            <div style="margin-bottom: 15px;">
                <strong>æ³¨å†Œæ—¶é—´:</strong> 
                <span style="color: #7f8c8d;">
                    <script>
                        document.write(new Date({{ user.created_at }} * 1000).toLocaleString('zh-CN'));
                    </script>
                </span>
            </div>
            
            {% if user.last_login %}
            <div>
                <strong>æœ€åç™»å½•:</strong> 
                <span style="color: #7f8c8d;">
                    <script>
                        document.write(new Date({{ user.last_login }} * 1000).toLocaleString('zh-CN'));
                    </script>
                </span>
            </div>
            {% endif %}
        </div>
    </div>
    
    <div class="card">
        <h3 style="color: #e74c3c; margin-bottom: 20px;">ğŸ”’ ä¿®æ”¹å¯†ç </h3>
        
        <form method="post" action="/auth/change-password">
            <div class="form-group">
                <label for="current_password">å½“å‰å¯†ç :</label>
                <input type="password" id="current_password" name="current_password" required 
                       placeholder="è¯·è¾“å…¥å½“å‰å¯†ç ">
            </div>
            
            <div class="form-group">
                <label for="new_password">æ–°å¯†ç :</label>
                <input type="password" id="new_password" name="new_password" required 
                       placeholder="è¯·è¾“å…¥æ–°å¯†ç " minlength="6">
                <small style="color: #7f8c8d;">å¯†ç é•¿åº¦è‡³å°‘6ä½</small>
            </div>
            
            <div class="form-group">
                <label for="confirm_password">ç¡®è®¤æ–°å¯†ç :</label>
                <input type="password" id="confirm_password" name="confirm_password" required 
                       placeholder="è¯·å†æ¬¡è¾“å…¥æ–°å¯†ç ">
            </div>
            
            <div style="text-align: center;">
                <button type="submit" class="btn btn-warning">
                    ğŸ”’ ä¿®æ”¹å¯†ç 
                </button>
            </div>
        </form>
    </div>
</div>

<div class="card" style="margin-top: 30px;">
    <h3 style="color: #27ae60; margin-bottom: 20px;">âš™ï¸ å¿«é€Ÿæ“ä½œ</h3>
    
    <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
        <a href="/dashboard" class="btn btn-primary">
            ğŸ“ˆ é¡¹ç›®ä»ªè¡¨æ¿
        </a>
        
        <a href="/ai-config" class="btn btn-info">
            ğŸ¤– AIé…ç½®
        </a>
        
        <a href="/auth/logout" class="btn btn-secondary" 
           onclick="return confirm('ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ')">
            ğŸšª é€€å‡ºç™»å½•
        </a>
    </div>
</div>

<div style="margin-top: 40px; padding: 30px; background: linear-gradient(135deg, #f8f9fa, #e9ecef); border-radius: 15px;">
    <h3 style="color: #2c3e50; margin-bottom: 20px; text-align: center;">ğŸ’¡ å®‰å…¨æç¤º</h3>
    
    <div class="grid">
        <div>
            <h4 style="color: #3498db; margin-bottom: 10px;">ğŸ” å¯†ç å®‰å…¨</h4>
            <p style="color: #7f8c8d; line-height: 1.6;">
                è¯·å®šæœŸæ›´æ¢å¯†ç ï¼Œä½¿ç”¨åŒ…å«å­—æ¯ã€æ•°å­—å’Œç‰¹æ®Šå­—ç¬¦çš„å¼ºå¯†ç ã€‚
            </p>
        </div>
        
        <div>
            <h4 style="color: #27ae60; margin-bottom: 10px;">ğŸ”’ ä¼šè¯ç®¡ç†</h4>
            <p style="color: #7f8c8d; line-height: 1.6;">
                åœ¨å…¬å…±è®¾å¤‡ä¸Šä½¿ç”¨åï¼Œè¯·åŠæ—¶é€€å‡ºç™»å½•ä»¥ä¿æŠ¤è´¦æˆ·å®‰å…¨ã€‚
            </p>
        </div>
        
        <div>
            <h4 style="color: #f39c12; margin-bottom: 10px;">ğŸ“§ é‚®ç®±éªŒè¯</h4>
            <p style="color: #7f8c8d; line-height: 1.6;">
                ç»‘å®šé‚®ç®±å¯ä»¥å¸®åŠ©æ‚¨åœ¨å¿˜è®°å¯†ç æ—¶å¿«é€Ÿæ¢å¤è´¦æˆ·ã€‚
            </p>
        </div>
        
        <div>
            <h4 style="color: #e74c3c; margin-bottom: 10px;">âš ï¸ å¼‚å¸¸æ´»åŠ¨</h4>
            <p style="color: #7f8c8d; line-height: 1.6;">
                å¦‚å‘ç°è´¦æˆ·å¼‚å¸¸æ´»åŠ¨ï¼Œè¯·ç«‹å³ä¿®æ”¹å¯†ç å¹¶è”ç³»ç®¡ç†å‘˜ã€‚
            </p>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// å¯†ç ç¡®è®¤éªŒè¯
document.getElementById('confirm_password').addEventListener('input', function() {
    const newPassword = document.getElementById('new_password').value;
    const confirmPassword = this.value;
    
    if (newPassword && confirmPassword && newPassword !== confirmPassword) {
        this.setCustomValidity('å¯†ç ä¸åŒ¹é…');
    } else {
        this.setCustomValidity('');
    }
});

document.getElementById('new_password').addEventListener('input', function() {
    const confirmPassword = document.getElementById('confirm_password');
    if (confirmPassword.value) {
        confirmPassword.dispatchEvent(new Event('input'));
    }
});
</script>
{% endblock %}
